library(dlm)
mod <- dlmModPoly(order=1)
mod
str(mod)
mod <- dlmModPoly(order=2)
str(mod)
mod <- dlmModPoly(order=1)
build_dlm <- function(par){}
build_dlm <- function(par){
mod$W[1,1] <- exp(par[1])
mod$V[1,1] <- exp(par[2])
return (mod)
}
lapply(list(c(0,0), c(1,10), c(20,3)), function(parms){dlmMLE(y=Nile, parm=parms, build=build_dlm)})
fit_dlm <- dlmMLE(y=Nile, parm=c(0,0), build=build_dlm, hessian=TRUE)
fit_dlm
exp(fit_dlm$par) * sqrt(diag(solve(fit_dlm$hessian)))
mod <- build_dlm(fit_dlm$par)
str(mod)
dlmFilrered_obj <- dlmFilter(y=Nile, mod=mod)
str(dlmFilrered_obj)
setwd("~/git/practice/R")
source('~/git/practice/R/ex73a.R', encoding = 'UTF-8', echo=TRUE)
library(rstan)
source('~/git/practice/R/ex73a.R', encoding = 'UTF-8', echo=TRUE)
e
ybar
s2
hist((e$x1), col="gray", freq=FALSE, xlim=c(-5,5), breaks=seq(-1000,1000,0.2))
source('~/git/practice/R/ex73a.R', encoding = 'UTF-8', echo=TRUE)
source('~/git/practice/R/ex73a.R', encoding = 'UTF-8', echo=TRUE)
e
e = extract(fit)
hist(e$mu, col="gray", freq=FALSE, xlim=c(-5,5), breaks=seq(-1000,1000,0.2))
hist(e$logsigma, col="gray", freq=FALSE, xlim=c(-5,5), breaks=seq(-1000,1000,0.2))
hist(exp(e$logsigma), col="gray", freq=FALSE, xlim=c(-5,5), breaks=seq(-1000,1000,0.2))
source('~/git/practice/R/ex73a.R', encoding = 'UTF-8', echo=TRUE)
hist(e$sigma, col="gray", freq=FALSE, xlim=c(-5,5), breaks=seq(-1000,1000,0.2))
source('~/git/practice/R/ex74.R', encoding = 'UTF-8', echo=TRUE)
data = list(n=3, y=c(11,13,16), sigma=c(1,1,2))
fit = stan("ex74b.stan", data=data, control=list(adapt_delta=0.99))
fit
library(metafor)
es = escalc(measure="AS", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg)
data = list(n=dim(es)[1], y=es$yi, sigma=sqrt(es$vi))
fit = stan("ex74b.stan", data=data, iter=26000, warmup=1000)
fit
es
install.packages("metafor")
library(metafor)
es = escalc(measure="AS", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg)
data = list(n=dim(es)[1], y=es$yi, sigma=sqrt(es$vi))
fit = stan("ex74b.stan", data=data, iter=26000, warmup=1000)
fit
fit
